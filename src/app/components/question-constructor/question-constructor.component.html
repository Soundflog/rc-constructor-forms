<tui-island class="tui-island">
  <form [formGroup]="mainQuestionsFG">
    <tui-tiles
      class="tiles"
      [(order)]="order"
    >
      <tui-tile
        class="content"
        *ngFor="let field of fields; let index = index"
        tuiTileHandle
        [formGroupName]="'questions_'+index"
        [class.tile_tall]="field.name === 'questions_'+index"
        [style.order]="order.get(index)"
        [height]="field.variants.length"
      >
        <tui-island class="tui-island">
          <div class="tui-row tui-space_bottom-5">
            <tui-textarea
              class="tui-col_md-6"
              [tuiTextfieldCleaner]=true
              tuiTextfieldSize="l"
              formControlName="content"
            >
              {{ field.content }}
              <textarea
                maxlength="97"
                placeholder="{{field.content}}"
                tuiTextfield
              ></textarea>
            </tui-textarea>
            <tui-combo-box
              class="tui-col_md-6"
              [formControl]="field.type"
              [stringify]="comboBoxStringify"
              [tuiTextfieldLabelOutside]="true"
            >
              {{comboBoxFields[0].value}}
              <tui-data-list-wrapper
                *tuiDataList
                [itemContent]="comboBoxStringify | tuiStringifyContent"
                [items]="comboBoxFields | tuiFilterByInputWith: comboBoxStringify"
              >
              </tui-data-list-wrapper>
            </tui-combo-box>
            <tui-svg
              src="tuiIconDragLarge"
              tuiTileHandle
              class="handle"
            ></tui-svg>
          </div>
          <!--          </div>-->
          <!--          TODO: по combobox отриросывать по type: либо *ngIf=comboBox.type (внутри component) либо попробовать по # -->
          <!--          One to Many-->

          <ng-container
            class="tui-row"
            *ngIf="field.type.value.type === QuestionType.SINGLE_CHOICE"
          >
            <div class="group"
                 formArrayName="variants"
            >
              <button
                appearance="outline"
                tuiButton
                size="s"
                (click)="addVariant(index)"
              >
                Добавить Вариант
              </button>
              <tui-elastic-container class="b-form">
                <ng-container
                  class="wrapper"
                  *ngFor="let variant of field.variants; let variantIndex=index"
                  [formGroupName]="variantIndex"
                >
                  <!--                <tui-radio-block contentAlign="right" size="l"
                                                   [pseudoDisabled]="false"
                                                   formControlName="content"
                                                   [item]="variant.content">
                                    {{variant.content}}
                                  </tui-radio-block>-->
                  <div class="">
                    <tui-input
                      [tuiTextfieldCleaner]="true"
                      tuiTextfieldSize="l"
                      formControlName="content">
                      {{variant.content}}
                      <input
                        tuiTextfield
                      />
                    </tui-input>
                    <button
                      appearance="flat"
                      icon="tuiIconTrash"
                      shape="rounded"
                      size="s"
                      title="Remove"
                      tuiIconButton
                      class="remove"
                      (click)="removeVariant(index, variantIndex)"
                    ></button>
                  </div>
                </ng-container>
              </tui-elastic-container>
            </div>
          </ng-container>

          <ng-container class="tui-row" tuiAccordionItemContent>
            <!--        Нижняя панель управления вопросом - Компонент-->
            <div tuiGroup class="group" [collapsed]="true">
              <button
                appearance="outline"
                tuiButton
                size="s"
                (click)="addField(index)"
              >
                Добавить
              </button>
              <button
                appearance="outline"
                tuiButton
                size="s"
                (click)="removeField(index)"
              >
                Удалить
              </button>
            </div>
          </ng-container>

        </tui-island>
      </tui-tile>
    </tui-tiles>
  </form>
</tui-island>
<button
  tuiButton
  size="xl"
  class=""
  type="submit"
  (click)="onSubmit()"
>
  Сохранить
</button>
